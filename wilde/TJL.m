function [TJ,TL] = TJL(phi,psi,q1,q2,q3,q4,theta,xG1,xG2,xG3)
%TJL
%    [TJ,TL] = TJL(PHI,PSI,Q1,Q2,Q3,Q4,THETA,xG1,xG2,xG3)

%    This function was generated by the Symbolic Math Toolbox version 24.1.
%    10-Nov-2024 12:27:27

t2 = cos(phi);
t3 = cos(psi);
t4 = cos(q1);
t5 = cos(q2);
t6 = cos(q3);
t7 = cos(q4);
t8 = cos(theta);
t9 = sin(phi);
t10 = sin(psi);
t11 = sin(q1);
t12 = sin(q2);
t13 = sin(q3);
t14 = sin(q4);
t15 = sin(theta);
t16 = -phi;
t17 = -theta;
t23 = q1+q2+q3+q4+theta;
t18 = t2.*t8;
t19 = t3.*t9;
t20 = t4.*t15;
t21 = t9.*t10;
t22 = t11.*t15;
t26 = phi+t23;
t27 = sin(t23);
t31 = t15./1.0e+1;
t32 = t2.*t3.*t4;
t33 = t3.*t4.*t8;
t34 = t2.*t3.*t11;
t35 = t2.*t4.*t10;
t36 = t2.*t3.*t15;
t37 = t4.*t8.*t9;
t38 = t3.*t8.*t11;
t39 = t4.*t8.*t10;
t41 = cos(t23);
t42 = t2.*t10.*t11;
t43 = t2.*t10.*t15;
t44 = t8.*t9.*t11;
t45 = t8.*t10.*t11;
t53 = (t2.*t3)./1.0e+1;
t54 = (t3.*t8)./1.0e+1;
t56 = (t2.*t10)./1.0e+1;
t57 = (t8.*t9)./1.0e+1;
t58 = (t8.*t10)./1.0e+1;
t95 = q1+q2+q3+q4+t17;
t102 = t16+t23;
t24 = t12.*t20;
t25 = t5.*t22;
t28 = t12.*t22;
t29 = -t19;
t30 = -t20;
t40 = t5.*t20;
t46 = t18.*(2.0./5.0);
t47 = t19.*(2.0./5.0);
t48 = t20.*(2.0./5.0);
t49 = t21.*(2.0./5.0);
t50 = -t31;
t51 = cos(t26);
t52 = sin(t26);
t60 = t5.*t32;
t61 = t5.*t33;
t62 = t12.*t32;
t63 = t5.*t34;
t64 = t5.*t35;
t65 = t5.*t37;
t66 = t12.*t33;
t67 = t5.*t38;
t68 = t5.*t39;
t70 = t12.*t34;
t71 = t12.*t35;
t72 = t5.*t42;
t73 = t19.*t20;
t74 = t12.*t37;
t75 = t5.*t44;
t76 = t12.*t38;
t77 = t12.*t39;
t78 = t5.*t45;
t82 = t12.*t42;
t83 = t19.*t22;
t84 = t20.*t21;
t85 = t12.*t44;
t86 = t12.*t45;
t90 = -t35;
t91 = -t38;
t93 = t21.*t22;
t96 = -t42;
t97 = -t45;
t99 = -t56;
t100 = cos(t95);
t101 = phi+t95;
t103 = sin(t95);
t104 = t33.*(2.0./5.0);
t105 = t34.*(2.0./5.0);
t106 = t36.*(2.0./5.0);
t107 = t39.*(2.0./5.0);
t109 = t42.*(2.0./5.0);
t110 = t43.*(2.0./5.0);
t111 = t44.*(2.0./5.0);
t112 = t21.*t31;
t113 = t41./2.0;
t114 = t27./2.0;
t167 = cos(t102);
t176 = sin(t102);
t182 = t19.*t31;
t215 = t21+t36;
t226 = t22+t37;
t309 = t16+t95;
t55 = -t47;
t59 = -t48;
t69 = t6.*t40;
t79 = t13.*t40;
t80 = t6.*t24;
t81 = t6.*t25;
t87 = t13.*t24;
t88 = t13.*t25;
t89 = t6.*t28;
t92 = t5.*t30;
t94 = t13.*t28;
t98 = t28.*(2.0./5.0);
t108 = t40.*(2.0./5.0);
t115 = t6.*t60;
t116 = t6.*t61;
t117 = t13.*t60;
t118 = t6.*t62;
t119 = t6.*t63;
t120 = t6.*t64;
t121 = t6.*t65;
t122 = t13.*t61;
t123 = t6.*t66;
t124 = t6.*t67;
t125 = t6.*t68;
t126 = t13.*t62;
t127 = t13.*t63;
t128 = t6.*t70;
t129 = t13.*t64;
t130 = t6.*t71;
t131 = t6.*t72;
t132 = t19.*t40;
t133 = t13.*t65;
t134 = t6.*t74;
t135 = t6.*t75;
t136 = t13.*t66;
t137 = t13.*t67;
t138 = t6.*t76;
t139 = t13.*t68;
t140 = t6.*t77;
t141 = t6.*t78;
t142 = t13.*t70;
t143 = t13.*t71;
t144 = t13.*t72;
t145 = t6.*t82;
t146 = t19.*t24;
t147 = t19.*t25;
t148 = t21.*t40;
t149 = t13.*t74;
t150 = t13.*t75;
t151 = t6.*t85;
t152 = t13.*t76;
t153 = t13.*t77;
t154 = t13.*t78;
t155 = t6.*t86;
t156 = -t64;
t157 = -t66;
t158 = -t67;
t159 = t13.*t82;
t162 = t21.*t24;
t163 = t21.*t25;
t164 = t13.*t85;
t165 = t13.*t86;
t166 = cos(t101);
t168 = -t70;
t169 = -t71;
t170 = -t72;
t171 = -t76;
t172 = -t77;
t173 = -t78;
t174 = t21.*t28;
t175 = sin(t101);
t177 = -t85;
t178 = -t86;
t181 = -t109;
t183 = -t113;
t184 = -t114;
t185 = t61.*(2.0./5.0);
t186 = t62.*(2.0./5.0);
t187 = t63.*(2.0./5.0);
t188 = t68.*(2.0./5.0);
t190 = t51./4.0;
t191 = t71.*(2.0./5.0);
t192 = t72.*(2.0./5.0);
t193 = t74.*(2.0./5.0);
t194 = t75.*(2.0./5.0);
t195 = t76.*(2.0./5.0);
t196 = t52./4.0;
t197 = t22.*t47;
t198 = t86.*(2.0./5.0);
t202 = t22.*t49;
t310 = t28.*t29;
t318 = cos(t309);
t319 = sin(t309);
t335 = t24.*t47;
t336 = t25.*t47;
t340 = t100./2.0;
t342 = t24.*t49;
t343 = t25.*t49;
t345 = t103./2.0;
t347 = t167./4.0;
t349 = t176./4.0;
t371 = t29+t43;
t382 = t30+t44;
t474 = t34+t39+t93;
t475 = t32+t84+t97;
t476 = t33+t83+t96;
t477 = t73+t90+t91;
t160 = t6.*t92;
t179 = -t108;
t180 = -t94;
t189 = t69.*(2.0./5.0);
t199 = t87.*(2.0./5.0);
t200 = t88.*(2.0./5.0);
t201 = t89.*(2.0./5.0);
t203 = t7.*t115;
t204 = t7.*t116;
t205 = t14.*t115;
t206 = t7.*t117;
t207 = t7.*t118;
t208 = t7.*t119;
t209 = t7.*t120;
t210 = t14.*t116;
t211 = t7.*t122;
t212 = t7.*t123;
t213 = t7.*t124;
t214 = t7.*t125;
t216 = t14.*t117;
t217 = t14.*t118;
t218 = t7.*t126;
t219 = t14.*t119;
t220 = t7.*t127;
t221 = t7.*t128;
t222 = t14.*t120;
t223 = t7.*t129;
t224 = t7.*t130;
t225 = t7.*t131;
t227 = t19.*t69;
t228 = t14.*t122;
t229 = t14.*t123;
t230 = t7.*t136;
t231 = t14.*t124;
t232 = t7.*t137;
t233 = t7.*t138;
t234 = t14.*t125;
t235 = t7.*t139;
t236 = t7.*t140;
t237 = t7.*t141;
t238 = t14.*t126;
t239 = t14.*t127;
t240 = t14.*t128;
t241 = t7.*t142;
t242 = t14.*t129;
t243 = t14.*t130;
t244 = t7.*t143;
t245 = t14.*t131;
t246 = t7.*t144;
t247 = t7.*t145;
t248 = t19.*t79;
t249 = t19.*t80;
t250 = t19.*t81;
t251 = t21.*t69;
t252 = t14.*t136;
t253 = t14.*t137;
t254 = t14.*t138;
t255 = t7.*t152;
t256 = t14.*t139;
t257 = t14.*t140;
t258 = t7.*t153;
t259 = t14.*t141;
t260 = t7.*t154;
t261 = t7.*t155;
t262 = -t120;
t263 = -t122;
t264 = -t123;
t265 = -t124;
t266 = t14.*t142;
t267 = t14.*t143;
t268 = t14.*t144;
t269 = t14.*t145;
t270 = t7.*t159;
t271 = t19.*t87;
t272 = t19.*t88;
t273 = t19.*t89;
t274 = t21.*t79;
t275 = t21.*t80;
t276 = t21.*t81;
t277 = t14.*t152;
t278 = t14.*t153;
t279 = t14.*t154;
t280 = t14.*t155;
t281 = t7.*t165;
t282 = -t126;
t283 = -t127;
t284 = -t128;
t285 = -t129;
t286 = -t130;
t287 = -t131;
t288 = -t136;
t289 = -t137;
t290 = -t138;
t291 = -t139;
t292 = -t140;
t293 = -t141;
t294 = t14.*t159;
t295 = t19.*t94;
t296 = t21.*t87;
t297 = t21.*t88;
t298 = t21.*t89;
t299 = t14.*t165;
t300 = -t142;
t301 = -t149;
t302 = -t150;
t303 = -t151;
t304 = -t153;
t305 = -t154;
t306 = -t155;
t307 = t21.*t94;
t311 = -t164;
t312 = -t190;
t313 = -t191;
t314 = -t192;
t315 = -t195;
t316 = -t174;
t317 = -t198;
t320 = t116.*(2.0./5.0);
t321 = t117.*(2.0./5.0);
t322 = t118.*(2.0./5.0);
t323 = t119.*(2.0./5.0);
t324 = t125.*(2.0./5.0);
t325 = t129.*(2.0./5.0);
t326 = t130.*(2.0./5.0);
t327 = t131.*(2.0./5.0);
t328 = t133.*(2.0./5.0);
t329 = t134.*(2.0./5.0);
t330 = t135.*(2.0./5.0);
t331 = t136.*(2.0./5.0);
t332 = t137.*(2.0./5.0);
t333 = t138.*(2.0./5.0);
t334 = t142.*(2.0./5.0);
t337 = t153.*(2.0./5.0);
t338 = t154.*(2.0./5.0);
t339 = t155.*(2.0./5.0);
t341 = t159.*(2.0./5.0);
t344 = t164.*(2.0./5.0);
t346 = t166./4.0;
t348 = t175./4.0;
t418 = t29.*t87;
t419 = t29.*t88;
t420 = t29.*t89;
t429 = t29.*t94;
t440 = -t349;
t441 = t47.*t79;
t442 = t47.*t80;
t443 = t47.*t81;
t444 = t49.*t79;
t445 = t49.*t80;
t446 = t49.*t81;
t449 = t14.*t29.*t79;
t450 = t14.*t29.*t80;
t452 = t14.*t29.*t81;
t459 = t13.*t14.*t21.*t92;
t471 = t318./4.0;
t472 = t319./4.0;
t478 = t24+t25+t65+t177;
t479 = t28+t74+t75+t92;
t480 = t62+t63+t68+t162+t163+t178;
t481 = t61+t146+t147+t169+t170+t171;
t483 = t82+t132+t156+t157+t158+t310;
t308 = -t189;
t350 = t7.*t227;
t351 = t14.*t227;
t352 = t7.*t248;
t353 = t7.*t249;
t354 = t7.*t250;
t355 = t7.*t251;
t356 = -t209;
t357 = -t210;
t358 = -t211;
t359 = -t212;
t360 = -t213;
t367 = t14.*t251;
t368 = t7.*t274;
t369 = t7.*t275;
t370 = t7.*t276;
t372 = -t216;
t373 = -t217;
t374 = -t218;
t375 = -t219;
t376 = -t220;
t377 = -t221;
t378 = -t222;
t379 = -t223;
t380 = -t224;
t381 = -t225;
t383 = -t228;
t384 = -t229;
t385 = -t230;
t386 = -t231;
t387 = -t232;
t388 = -t233;
t389 = -t234;
t390 = -t235;
t391 = -t236;
t392 = -t237;
t393 = t14.*t271;
t394 = t14.*t272;
t395 = t14.*t273;
t396 = t7.*t295;
t398 = t14.*t275;
t399 = t7.*t296;
t400 = t14.*t276;
t401 = t7.*t297;
t402 = t7.*t298;
t403 = -t238;
t404 = -t239;
t405 = -t240;
t406 = -t241;
t407 = -t256;
t408 = -t257;
t409 = -t258;
t410 = -t259;
t411 = -t260;
t412 = -t261;
t413 = t14.*t295;
t414 = t14.*t296;
t415 = t14.*t297;
t416 = t14.*t298;
t417 = t7.*t307;
t421 = t14.*t307;
t422 = -t325;
t423 = -t326;
t424 = -t327;
t425 = -t331;
t426 = -t332;
t427 = -t333;
t428 = -t294;
t430 = -t296;
t431 = -t297;
t432 = -t298;
t433 = -t334;
t434 = -t337;
t435 = -t338;
t436 = -t339;
t437 = t21.*t180;
t438 = -t344;
t439 = -t346;
t451 = t7.*t418;
t453 = t7.*t419;
t454 = t7.*t420;
t455 = t14.*t418;
t456 = t14.*t419;
t457 = t14.*t420;
t458 = t7.*t429;
t469 = t295.*(-2.0./5.0);
t470 = t307.*(-2.0./5.0);
t473 = -t472;
t482 = t60+t148+t168+t172+t173+t316;
t484 = t87+t88+t89+t133+t134+t135+t160+t311;
t487 = t79+t80+t81+t121+t180+t301+t302+t303;
t489 = t116+t159+t248+t249+t250+t285+t286+t287+t288+t289+t290+t429;
t490 = t143+t144+t145+t152+t227+t262+t263+t264+t265+t418+t419+t420;
t460 = -t398;
t461 = -t399;
t462 = -t400;
t463 = -t401;
t464 = -t402;
t465 = -t414;
t466 = -t415;
t467 = -t416;
t468 = t7.*t437;
t485 = t184+t312+t345+t347+t439+t471;
t486 = t183+t196+t340+t348+t440+t473;
t488 = t117+t118+t119+t125+t274+t275+t276+t300+t304+t305+t306+t437;
t491 = t115+t165+t251+t282+t283+t284+t291+t292+t293+t430+t431+t432;
t492 = t242+t243+t244+t245+t246+t247+t252+t253+t254+t255+t350+t356+t357+t358+t359+t360+t413+t428+t449+t450+t451+t452+t453+t454;
t493 = t204+t267+t268+t269+t270+t277+t351+t352+t353+t354+t378+t379+t380+t381+t383+t384+t385+t386+t387+t388+t455+t456+t457+t458;
t494 = t205+t206+t207+t208+t214+t299+t367+t368+t369+t370+t403+t404+t405+t406+t407+t408+t409+t410+t411+t412+t465+t466+t467+t468;
t495 = t203+t266+t278+t279+t280+t281+t355+t372+t373+t374+t375+t376+t377+t389+t390+t391+t392+t421+t459+t460+t461+t462+t463+t464;
TJ = reshape([t3.*t8,t8.*t10,-t15,0.0,-t2.*t10+t15.*t19,t2.*t3+t15.*t21,t8.*t9,0.0,t215,t371,t18,0.0,t49+t54+t99+t106+t182+xG1,t53+t55+t58+t110+t112+xG2,t46+t50+t57+xG3,1.0,t476,t474,t382,0.0,t477,t475,t226,0.0,t215,t371,t18,0.0,t49+t54+t99+t104+t106+t181+t182+t197+xG1,t53+t55+t58+t105+t107+t110+t112+t202+xG2,t46+t50+t57+t59+t111+xG3,1.0,t481,t480,t479,0.0,t483,t482,t478,0.0,t215,t371,t18,0.0,t49+t54+t99+t104+t106+t181+t182+t185+t197+t313+t314+t315+t335+t336+xG1,t53+t55+t58+t105+t107+t110+t112+t186+t187+t188+t202+t317+t342+t343+xG2,t46+t50+t57+t59+t98+t111+t179+t193+t194+xG3,1.0,t489,t488,t484,0.0,t490,t491,t487,0.0,t215,t371,t18,0.0,t49+t54+t99+t104+t106+t181+t182+t185+t197+t313+t314+t315+t320+t335+t336+t341+t422+t423+t424+t425+t426+t427+t441+t442+t443+t469+xG1,t53+t55+t58+t105+t107+t110+t112+t186+t187+t188+t202+t317+t321+t322+t323+t324+t342+t343+t433+t434+t435+t436+t444+t445+t446+t470+xG2,t46+t50+t57+t59+t98+t111+t179+t193+t194+t199+t200+t201+t308+t328+t329+t330+t438+xG3,1.0,t493,t494,t485,0.0,t492,t495,t486,0.0,t215,t371,t18,0.0,t49+t54+t99+t104+t106+t181+t182+t185+t197+t204.*(2.0./5.0)-t222.*(2.0./5.0)-t223.*(2.0./5.0)-t224.*(2.0./5.0)-t225.*(2.0./5.0)-t228.*(2.0./5.0)-t229.*(2.0./5.0)-t230.*(2.0./5.0)-t231.*(2.0./5.0)-t232.*(2.0./5.0)-t233.*(2.0./5.0)+t267.*(2.0./5.0)+t268.*(2.0./5.0)+t269.*(2.0./5.0)+t270.*(2.0./5.0)+t277.*(2.0./5.0)+t313+t314+t315+t320+t335+t336+t341-t393.*(2.0./5.0)-t394.*(2.0./5.0)-t395.*(2.0./5.0)-t396.*(2.0./5.0)+t422+t423+t424+t425+t426+t427+t441+t442+t443+t469+xG1+t7.*t441+t7.*t442+t7.*t443+t14.*t47.*t69,t53+t55+t58+t105+t107+t110+t112+t186+t187+t188+t202+t205.*(2.0./5.0)+t206.*(2.0./5.0)+t207.*(2.0./5.0)+t208.*(2.0./5.0)+t214.*(2.0./5.0)-t238.*(2.0./5.0)-t239.*(2.0./5.0)-t240.*(2.0./5.0)-t241.*(2.0./5.0)-t256.*(2.0./5.0)-t257.*(2.0./5.0)-t258.*(2.0./5.0)-t259.*(2.0./5.0)-t260.*(2.0./5.0)-t261.*(2.0./5.0)+t299.*(2.0./5.0)+t317+t321+t322+t323+t324+t342+t343-t414.*(2.0./5.0)-t415.*(2.0./5.0)-t416.*(2.0./5.0)-t417.*(2.0./5.0)+t433+t434+t435+t436+t444+t445+t446+t470+xG2+t7.*t444+t7.*t445+t7.*t446+t14.*t49.*t69,t46+t50+t57+t59+t98+t111+t179+t193+t194+t199+t200+t201+t308+t328+t329+t330+t438+xG3-t7.*t69.*(2.0./5.0)+t14.*t79.*(2.0./5.0)+t14.*t80.*(2.0./5.0)+t14.*t81.*(2.0./5.0)-t14.*t94.*(2.0./5.0)+t14.*t121.*(2.0./5.0)-t14.*t149.*(2.0./5.0)-t14.*t150.*(2.0./5.0)-t14.*t151.*(2.0./5.0)-t7.*t164.*(2.0./5.0)+t7.*t199+t7.*t200+t7.*t201+t7.*t328+t7.*t329+t7.*t330,1.0],[4,4,5]);
if nargout > 1
    TL = reshape([t476,t474,t382,0.0,t477,t475,t226,0.0,t215,t371,t18,0.0,t33./5.0-t42./5.0+t49+t54+t83./5.0+t99+t106+t182+xG1,t34./5.0+t39./5.0+t53+t55+t58+t93./5.0+t110+t112+xG2,t20.*(-1.0./5.0)+t44./5.0+t46+t50+t57+xG3,1.0,t481,t480,t479,0.0,t483,t482,t478,0.0,t215,t371,t18,0.0,t49+t54+t61./5.0-t71./5.0-t72./5.0-t76./5.0+t99+t104+t106+t146./5.0+t147./5.0+t181+t182+t197+xG1,t53+t55+t58+t62./5.0+t63./5.0+t68./5.0-t86./5.0+t105+t107+t110+t112+t162./5.0+t163./5.0+t202+xG2,t28./5.0-t40./5.0+t46+t50+t57+t59+t74./5.0+t75./5.0+t111+xG3,1.0,t489,t488,t484,0.0,t490,t491,t487,0.0,t215,t371,t18,0.0,t49+t54+t99+t104+t106+t116./5.0-t129./5.0-t130./5.0-t131./5.0-t136./5.0-t137./5.0-t138./5.0+t159./5.0+t181+t182+t185+t197+t248./5.0+t249./5.0+t250./5.0-t295./5.0+t313+t314+t315+t335+t336+xG1,t53+t55+t58+t105+t107+t110+t112+t117./5.0+t118./5.0+t119./5.0+t125./5.0-t142./5.0-t153./5.0-t154./5.0-t155./5.0+t186+t187+t188+t202+t274./5.0+t275./5.0+t276./5.0-t307./5.0+t317+t342+t343+xG2,t46+t50+t57+t59-t69./5.0+t87./5.0+t88./5.0+t89./5.0+t98+t111+t133./5.0+t134./5.0+t135./5.0-t164./5.0+t179+t193+t194+xG3,1.0,t493,t494,t485,0.0,t492,t495,t486,0.0,t215,t371,t18,0.0,t49+t54+t99+t104+t106+t181+t182+t185+t197+t204./5.0-t222./5.0-t223./5.0-t224./5.0-t225./5.0-t228./5.0-t229./5.0-t230./5.0-t231./5.0-t232./5.0-t233./5.0+t267./5.0+t268./5.0+t269./5.0+t270./5.0+t277./5.0+t313+t314+t315+t320+t335+t336+t341+t351./5.0+t352./5.0+t353./5.0+t354./5.0-t393./5.0-t394./5.0-t395./5.0-t396./5.0+t422+t423+t424+t425+t426+t427+t441+t442+t443+t469+xG1,t53+t55+t58+t105+t107+t110+t112+t186+t187+t188+t202+t205./5.0+t206./5.0+t207./5.0+t208./5.0+t214./5.0-t238./5.0-t239./5.0-t240./5.0-t241./5.0-t256./5.0-t257./5.0-t258./5.0-t259./5.0-t260./5.0-t261./5.0+t299./5.0+t317+t321+t322+t323+t324+t342+t343+t367./5.0+t368./5.0+t369./5.0+t370./5.0-t414./5.0-t415./5.0-t416./5.0-t417./5.0+t433+t434+t435+t436+t444+t445+t446+t470+xG2,t46+t50+t57+t59+t98+t111+t179+t193+t194+t199+t200+t201+t308+t328+t329+t330+t438+xG3-(t7.*t69)./5.0+(t14.*t79)./5.0+(t7.*t87)./5.0+(t14.*t80)./5.0+(t7.*t88)./5.0+(t14.*t81)./5.0+(t7.*t89)./5.0-(t14.*t94)./5.0+(t14.*t121)./5.0+(t7.*t133)./5.0+(t7.*t134)./5.0+(t7.*t135)./5.0-(t14.*t149)./5.0-(t14.*t150)./5.0-(t14.*t151)./5.0-(t7.*t164)./5.0,1.0],[4,4,4]);
end
end
